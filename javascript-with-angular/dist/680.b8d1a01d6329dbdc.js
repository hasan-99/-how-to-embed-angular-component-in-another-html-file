"use strict";(self.webpackChunkEvents_Customers=self.webpackChunkEvents_Customers||[]).push([[680],{7680:(Ce,A,r)=>{r.r(A),r.d(A,{CustomerProfileModule:()=>Te});var R=r(6594),p=r(6895),u=r(5861),D=r(3905);class Y{}var t=r(4650),I=r(9717),y=r(4752),J=r(2074),x=r(5685),Q=r(4475),Z=r(7756),P=r(8783),c=r(4006);class C{constructor(s){this.customerId=s?.customerId||0,this.firstName=s?.firstName||"",this.lastName=s?.lastName||"",this.email=s?.email||"",this.mobile=s?.mobile||"",this.image=s?.image||"",this.fileName=s?.fileName||"",this.address=s?.address?new w(s.address):new w}}class w{constructor(s){this.addressId=s?.addressId||0,this.countryId=s?.countryId||null,this.cityId=s?.cityId||null,this.address1=s?.address1||"",this.address2=s?.address2||"",this.postCode=s?.postCode||""}}var f=r(9808),d=r(6159),H=r(8052),S=r(529),b=r(1290);let N=(()=>{class o{constructor(e){this.http=e}getCountries(){return this.http.get(b.z.COMMON.GetCountries)}getCitiesByCountry(e){let n=(new S.LE).set("countryId",e.toString());return this.http.get(b.z.COMMON.GetCitiesByCountry,{params:n})}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(S.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var v=r(805),F=r(8678),m=r(3416),k=r(2210),O=r(4341),L=r(1740);function j(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"form",6)(3,"div",1)(4,"div",18)(5,"p"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",7)(9,"span",8),t._UZ(10,"input",19),t.TgZ(11,"label",10),t._uU(12),t.ALo(13,"translate"),t.qZA()()(),t.TgZ(14,"div",7)(15,"span",8),t._UZ(16,"input",20),t.TgZ(17,"label",10),t._uU(18),t.ALo(19,"translate"),t.qZA()()(),t.TgZ(20,"div",7)(21,"span",8),t._UZ(22,"input",21),t.TgZ(23,"label",10),t._uU(24),t.ALo(25,"translate"),t.qZA()()()(),t.TgZ(26,"div",22)(27,"p"),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"div",7)(31,"span",8),t._UZ(32,"input",23),t.TgZ(33,"label",10),t._uU(34),t.ALo(35,"translate"),t.qZA()()(),t.TgZ(36,"div",7)(37,"p-dropdown",24),t.NdJ("onChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onCountryChange(i))}),t.ALo(38,"translate"),t.qZA()(),t.TgZ(39,"div",7),t._UZ(40,"p-dropdown",25),t.ALo(41,"translate"),t.qZA()(),t.TgZ(42,"div",26)(43,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveChanges())}),t._uU(44),t.ALo(45,"translate"),t.qZA()()()()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.customerProfileForm),t.xp6(4),t.Oqu(t.lcZ(7,16,"PROFILE.PERSONAL_DETAILS")),t.xp6(6),t.Oqu(t.lcZ(13,18,"PROFILE.EMAIL")),t.xp6(6),t.Oqu(t.lcZ(19,20,"PROFILE.FIRST_NAME")),t.xp6(6),t.Oqu(t.lcZ(25,22,"PROFILE.LAST_NAME")),t.xp6(4),t.Oqu(t.lcZ(29,24,"PROFILE.EXTRA_INFORMATION")),t.xp6(6),t.Oqu(t.lcZ(35,26,"PROFILE.MOBILE_PHONE")),t.xp6(3),t.s9C("placeholder",t.lcZ(38,28,"PROFILE.COUNTRY")),t.Q6J("options",e.countries)("showClear",!0)("showClear",!0),t.xp6(3),t.s9C("placeholder",t.lcZ(41,30,"PROFILE.CITY")),t.Q6J("options",e.cities)("showClear",!0),t.xp6(3),t.Q6J("disabled",e.isFormChanged),t.xp6(1),t.hij(" ",t.lcZ(45,32,"PROFILE.SAVE_CHANGES"),"")}}function B(o,s){1&o&&(t.TgZ(0,"small",29),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PROFILE.SECURITY.PASSWORD_REQUIRMENTS")," "))}function G(o,s){if(1&o&&(t.TgZ(0,"div",27),t.YNc(1,B,3,3,"small",28),t.qZA()),2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.passwordForm.get("newPass1"))||null==n.errors?null:n.errors.pattern)}}function K(o,s){1&o&&(t.TgZ(0,"div")(1,"p",30),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PROFILE.PASSWORDS_DO_NOT_MATCH")))}let V=(()=>{class o{constructor(e,n,i,a,l,g,h,T){this.fb=e,this.customerHttpService=n,this.commonHttpService=i,this.messageService=a,this.confirmationService=l,this.breakpointObserver=g,this.translateService=h,this.customerService=T,this.changesSaved=new t.vpe,this.imageSize=2e7,this.eventtHasPoter=!1,this.uploadedPoster="",this.countries=[],this.cities=[],this.imageLoading=!0,this.displayImage=!1,this.passwordMatchError=!1,this.isFormChanged=!0}ngOnInit(){this.iniCountries(),this.iniCustomerProfile(),this.createPasswordForm()}iniCustomerProfile(){var e=this;return(0,u.Z)(function*(){const n=yield(0,f.n)(e.customerHttpService.getCustomerInfo());if(n){if(e.customerProfile=n,e.imagePlaceHolder="data: "+n.contentType+";base64,"+n.image,e.customerProfile.image&&(e.customerProfile.fileName="profile.png",e.displayImage=!0,e.customerProfile.address.countryId)){const i=yield(0,f.n)(e.commonHttpService.getCitiesByCountry(e.customerProfile.address.countryId));i&&(e.cities=i.map(a=>({label:a.name,value:a.cityId})))}}else e.customerProfile=new C;e.imageLoading=!1,e.createForm(),e.customerProfileForm.valueChanges.subscribe(()=>{e.isFormChanged=!1}),e.customerService.setCustomerEmail(e.customerProfile.email)})()}onDelete(){var n,e=this;this.confirmationService.confirm({header:this.translateService.instant("PROFILE.DELETE_PIC"),message:this.translateService.instant("PROFILE.DELETE_PIC_DETAILS"),icon:"pi pi-exclamation-triangle",accept:(n=(0,u.Z)(function*(){e.imageLoading=!0,(yield(0,f.n)(e.customerHttpService.deleteCustomerProfilePicture()))&&(e.displayImage=!1),e.imageLoading=!1}),function(){return n.apply(this,arguments)}),acceptLabel:this.translateService.instant("GENERAL.TITLE_DELETE"),rejectLabel:this.translateService.instant("GENERAL.TITLE_CANCEL"),acceptIcon:"'",rejectIcon:"'"})}iniCountries(){var e=this;return(0,u.Z)(function*(){const n=yield(0,f.n)(e.commonHttpService.getCountries());n&&(e.countries=n.map(i=>({label:i.name,value:i.countryId})))})()}onCountryChange(e){var n=this;return(0,u.Z)(function*(){const i=e.value,a=yield(0,f.n)(n.commonHttpService.getCitiesByCountry(i));a&&(n.cities=a.map(l=>({label:l.name,value:l.cityId})))})()}createForm(){this.customerProfileForm=this.fb.group({firstName:[this.customerProfile.firstName,[c.kI.required,d.Fd]],lastName:[this.customerProfile.lastName,[c.kI.required,d.Fd]],addressId:[this.customerProfile?.address?.addressId],address1:[this.customerProfile?.address?.address1,[d.Fd]],address2:[this.customerProfile?.address?.address2,[d.Fd]],postCode:[this.customerProfile?.address?.postCode,[d.Fd]],mobile:[this.customerProfile?.mobile,[d.Fd,c.kI.pattern("^[0-9]*$")]],countryId:[this.customerProfile?.address?.countryId],cityId:[this.customerProfile?.address?.cityId],image:[this.customerProfile.image],fileName:[this.customerProfile.fileName],email:[{value:this.customerProfile.email,disabled:!0}]},{validators:[d.qf]})}prepareCustomerProfile(){const e=this.customerProfileForm.controls,n=new C;return n.firstName=e.firstName.value,n.lastName=e.lastName.value,n.address.addressId=e.addressId.value,n.address.address1="",n.address.address2="",n.address.postCode="",n.mobile=e.mobile.value.toString(),n.address.countryId=e.countryId.value,n.address.cityId=e.cityId.value,n.image=e.image.value,n.fileName=e.fileName.value??"",n.email=e.email.value,n}onUpload(e){const n=new FileReader;n.readAsDataURL(this.uploadedFile),n.onload=()=>{this.base64Image=n.result,this.base64Image=this.base64Image.substring(this.base64Image.indexOf("base64")+7),this.customerProfileForm.controls.image.setValue(this.base64Image);const i=this.getFileName();this.customerProfileForm.controls.fileName.setValue(i)}}getFileName(){return this.uploadedFile.name.length>100?this.uploadedFile.name.substring(0,99)+"."+this.uploadedFile.type.substring(6):this.uploadedFile.name}onSelect(e){this.customerProfileForm.controls.image.reset(),this.customerProfileForm.controls.fileName.reset(),this.uploadedFile&&(this.uploadedFile=null),this.uploadedFile=e.files[0],this.imagePlaceHolder=URL.createObjectURL(this.uploadedFile),this.displayImage=!0}saveChanges(){var e=this;return(0,u.Z)(function*(){if(e.customerProfileForm.invalid)return;const n=e.prepareCustomerProfile();(yield(0,f.n)(e.customerHttpService.saveCustomerInfo(n)))&&(e.messageService.add({severity:"success",summary:e.translateService.instant("PROFILE.UPDATE"),detail:e.translateService.instant("PROFILE.UPDATE_DETAILS")}),e.changesSaved.emit()),e.isFormChanged=!0})()}createPasswordForm(){this.passwordForm=this.fb.group({currentPass:["",c.kI.required],newPass1:["",[c.kI.required,c.kI.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(.{5,})$")]],newPass2:["",c.kI.required]}),d.dN.MatchValidator("newPass1","newPass2")}onSubmitPassword(){var e=this;return(0,u.Z)(function*(){if(e.passwordForm.invalid)return;const n=e.passwordForm.get("newPass1")?.value??"";if(n!==(e.passwordForm.get("newPass2")?.value??""))return void(e.passwordMatchError=!0);e.passwordMatchError=!1;const a={oldPassword:e.passwordForm.get("currentPass")?.value??"",newPassword:n};e.customerHttpService.updatePassword(H.x.make(a)).subscribe(l=>{l&&(e.passwordForm.reset(),e.messageService.add({severity:"success",summary:e.translateService.instant("PROFILE.UPDATE"),detail:e.translateService.instant("PROFILE.PASSWORD_DETAILS")}),e.changesSaved.emit())})})()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(c.qu),t.Y36(I.r),t.Y36(N),t.Y36(v.ez),t.Y36(v.YP),t.Y36(F.Yg),t.Y36(m.sK),t.Y36(x.v))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-my-profile"]],outputs:{changesSaved:"changesSaved"},decls:34,vars:26,consts:[[1,"container-fluid"],[1,"row"],["class","col-md-8",4,"ngIf"],[1,"col-md-4","mt-md-0","mt-4"],[1,"card","px-4","p-3"],[1,"ps-0"],[3,"formGroup"],[1,"col-12","space"],[1,"p-float-label"],["formControlName","currentPass",3,"feedback","toggleMask"],["for","inputtext"],["type","password","formControlName","newPass1",3,"feedback","toggleMask"],["class","col-12 error-msg",4,"ngIf"],["formControlName","newPass2",3,"feedback","toggleMask"],[4,"ngIf"],["type","button",1,"event-primary","w-100",3,"disabled","click"],[1,"col-md-8"],[1,"card","p-3"],[1,"col-12","col-md-6","border-end"],["type","email","id","inputtext","pInputText","","formControlName","email"],["type","text","id","inputtext","pInputText","","formControlName","firstName"],["type","text","id","inputtext","pInputText","","formControlName","lastName"],[1,"col-12","col-md-6"],["type","number","id","inputtext","pInputText","","formControlName","mobile"],["styleClass","w-100","formControlName","countryId",3,"options","showClear","placeholder","onChange"],["styleClass","w-100","formControlName","cityId",3,"options","showClear","placeholder"],[1,"col-12","space-button"],[1,"col-12","error-msg"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"text-danger","fs-6","pt-1"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,j,46,34,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"p",5),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"form",6)(9,"div",1)(10,"div",7)(11,"span",8),t._UZ(12,"p-password",9),t.TgZ(13,"label",10),t._uU(14),t.ALo(15,"translate"),t.qZA()()(),t.TgZ(16,"div",7)(17,"span",8),t._UZ(18,"p-password",11),t.TgZ(19,"label",10),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.YNc(22,G,2,1,"div",12),t.qZA(),t.TgZ(23,"div",7)(24,"span",8),t._UZ(25,"p-password",13),t.TgZ(26,"label",10),t._uU(27),t.ALo(28,"translate"),t.qZA()()(),t.YNc(29,K,4,3,"div",14),t.TgZ(30,"div",7)(31,"button",15),t.NdJ("click",function(){return i.onSubmitPassword()}),t._uU(32),t.ALo(33,"translate"),t.qZA()()()()()()()()),2&n){let a;t.xp6(2),t.Q6J("ngIf",i.customerProfileForm),t.xp6(4),t.Oqu(t.lcZ(7,16,"PROFILE.CHANGE_PASSWORD")),t.xp6(2),t.Q6J("formGroup",i.passwordForm),t.xp6(4),t.Q6J("feedback",!1)("toggleMask",!0),t.xp6(2),t.Oqu(t.lcZ(15,18,"PROFILE.CURRENT_PASSWORD")),t.xp6(4),t.Q6J("feedback",!1)("toggleMask",!0),t.xp6(2),t.Oqu(t.lcZ(21,20,"PROFILE.NEW_PASSWORD")),t.xp6(2),t.Q6J("ngIf",(null==(a=i.passwordForm.get("newPass1"))?null:a.invalid)&&(null==(a=i.passwordForm.get("newPass1"))?null:a.touched)),t.xp6(3),t.Q6J("feedback",!1)("toggleMask",!0),t.xp6(2),t.Oqu(t.lcZ(28,22,"PROFILE.CONFIRM_NEW_PASSWORD")),t.xp6(2),t.Q6J("ngIf",i.passwordMatchError),t.xp6(2),t.Q6J("disabled",i.passwordForm.invalid),t.xp6(1),t.Oqu(t.lcZ(33,24,"PROFILE.SAVE_CHANGES"))}},dependencies:[p.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,k.Lt,O.ro,L.o,m.X$],styles:[".space[_ngcontent-%COMP%]{padding:10px 10px 20px}.space-button[_ngcontent-%COMP%]{padding:13px 22px}.card[_ngcontent-%COMP%]{border:unset!important}.event-primary[_ngcontent-%COMP%]:hover{background:#2FD99E!important}.event-primary[_ngcontent-%COMP%]{border-radius:8px!important;background:#2FD99E!important}.container-fluid[_ngcontent-%COMP%]{width:100%;max-width:1800px;margin:0 auto}.container-fluid[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:start;color:#000;font-size:24px;font-weight:600;padding-left:10px}[_nghost-%COMP%]     .p-dropdown.p-dropdown-clearable .p-dropdown-label{padding-right:1.75rem;display:flex!important}"]})}return o})();var $=r(5700),z=r(2449),E=r(5254),W=r(8322),X=r(3947),tt=r(9650),U=r(5593),et=r(1795),q=r(100);function nt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"img",27),t.NdJ("error",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.onImageLoadError())}),t.qZA()}if(2&o){const e=t.oxw(3);t.Q6J("src",e.src,t.LSH)}}function ot(o,s){if(1&o&&t._UZ(0,"img",28),2&o){const e=t.oxw(3);t.Q6J("src",e.placeHolderImage,t.LSH)}}function it(o,s){if(1&o&&(t.TgZ(0,"div",24),t.YNc(1,nt,1,1,"img",25),t.YNc(2,ot,1,1,"img",26),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.showPlaceholderImage),t.xp6(1),t.Q6J("ngIf",e.showPlaceholderImage)}}function st(o,s){if(1&o&&(t.TgZ(0,"div",30),t._UZ(1,"qrcode",31),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("qrdata",e.ticket.code)("width",120)("errorCorrectionLevel","M")("elementType","img")}}function at(o,s){if(1&o&&(t.TgZ(0,"div",24),t.YNc(1,st,2,4,"div",29),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.ticket.code)}}function rt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"span",11),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",14),t._uU(5),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PROFILE.SEAT")),t.xp6(3),t.Oqu(e.ticket.bookableObjectLabel)}}function ct(o,s){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",32)(2,"button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.displayQRCode())}),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",32)(6,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.downloadTicket(i.ticket.ticketId))}),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"div",35)(10,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addExtraTickets(i.ticket))}),t._uU(11," Add Extra Ticket"),t.qZA()(),t.BQk()}2&o&&(t.xp6(3),t.hij(" ",t.lcZ(4,2,"BUTTONS.SCAN"),""),t.xp6(4),t.hij(" ",t.lcZ(8,4,"BUTTONS.DOWNLOAD"),""))}function lt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",36)(1,"button",33),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.displayQRCode())}),t._uU(2),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"div",37)(5,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.downloadTicket(i.ticket.ticketId))}),t._uU(6),t.ALo(7,"translate"),t.qZA()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"BUTTONS.SCAN"),""),t.xp6(4),t.hij(" ",t.lcZ(7,4,"BUTTONS.DOWNLOAD"),""))}function dt(o,s){if(1&o&&(t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t.YNc(3,it,3,2,"div",5),t.YNc(4,at,2,1,"div",5),t.TgZ(5,"div",6)(6,"div",7)(7,"div",8)(8,"div",9)(9,"div",10)(10,"span",11),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"p",12),t._uU(14),t.qZA()(),t.TgZ(15,"div",13)(16,"span",11),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"p",14),t._uU(20),t.qZA()(),t.TgZ(21,"div",15)(22,"p",16),t._uU(23),t.qZA()(),t.TgZ(24,"div",17),t.YNc(25,rt,6,4,"div",18),t.qZA(),t.TgZ(26,"div",15)(27,"p",19),t._uU(28),t.qZA()(),t.TgZ(29,"div",15)(30,"p",20),t._uU(31),t.qZA()()()()()(),t.TgZ(32,"div",21),t.YNc(33,ct,12,6,"ng-container",22),t.YNc(34,lt,8,6,"ng-template",null,23,t.W1O),t.qZA()()()()),2&o){const e=t.MAs(35),n=t.oxw();t.xp6(3),t.Q6J("ngIf",!n.showQRCode),t.xp6(1),t.Q6J("ngIf",n.showQRCode),t.xp6(7),t.Oqu(t.lcZ(12,12,"PROFILE.TICKET_NO")),t.xp6(3),t.Oqu(n.ticket.ticketId),t.xp6(3),t.Oqu(t.lcZ(18,14,"PROFILE.TYPE")),t.xp6(3),t.Oqu(n.ticket.ticketTypeName),t.xp6(3),t.Oqu(n.ticket.eventInstanceName),t.xp6(2),t.Q6J("ngIf",n.shouldDisplayBookableObjectLabel()),t.xp6(3),t.Oqu(n.ticket.startDate),t.xp6(3),t.Oqu(n.ticket.venueName),t.xp6(2),t.Q6J("ngIf",!n.ticket.renderSeatmap)("ngIfElse",e)}}function pt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",40),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",51),t._uU(5),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PROFILE.SEAT")),t.xp6(3),t.Oqu(e.ticket.bookableObjectLabel)}}function ut(o,s){if(1&o&&(t.TgZ(0,"div",52),t._UZ(1,"qrcode",31),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("qrdata",e.ticket.code)("width",120)("errorCorrectionLevel","M")("elementType","img")}}function mt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",38)(1,"div",39)(2,"div",4)(3,"div",40),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",41),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"div",42),t._uU(10),t.qZA(),t.TgZ(11,"div",43),t._uU(12),t.qZA(),t.TgZ(13,"div",44),t._uU(14),t.qZA(),t.YNc(15,pt,6,4,"div",18),t.TgZ(16,"div",45),t._uU(17),t.qZA(),t.TgZ(18,"div",46),t._uU(19),t.qZA(),t.TgZ(20,"div",47)(21,"u",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.downloadTicket(i.ticket.ticketId))}),t._uU(22),t.ALo(23,"translate"),t.qZA()()(),t.YNc(24,ut,2,4,"div",49),t.TgZ(25,"div",50)(26,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addExtraTickets(i.ticket))}),t._uU(27," Add Extr Ticket"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,10,"PROFILE.TICKET_NO")),t.xp6(3),t.Oqu(t.lcZ(8,12,"PROFILE.TYPE")),t.xp6(3),t.Oqu(e.ticket.ticketId),t.xp6(2),t.Oqu(e.ticket.ticketTypeName),t.xp6(2),t.Oqu(e.ticket.eventInstanceName),t.xp6(1),t.Q6J("ngIf",e.shouldDisplayBookableObjectLabel()),t.xp6(2),t.Oqu(e.ticket.startDate),t.xp6(2),t.Oqu(e.ticket.venueName),t.xp6(3),t.Oqu(t.lcZ(23,14,"BUTTONS.DOWNLOAD")),t.xp6(2),t.Q6J("ngIf",e.ticket.code)}}function ft(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"img",27),t.NdJ("error",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onImageLoadError())}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("src",e.src,t.LSH)}}function gt(o,s){if(1&o&&t._UZ(0,"img",28),2&o){const e=t.oxw(2);t.Q6J("src",e.placeHolderImage,t.LSH)}}function vt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"span",11),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",14),t._uU(5),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PROFILE.TYPE")),t.xp6(3),t.Oqu(e.ticketHistory.bookableObjectLabel)}}function ht(o,s){if(1&o&&(t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",24),t.YNc(4,ft,1,1,"img",25),t.YNc(5,gt,1,1,"img",26),t.qZA(),t.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"span",11),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"p",12),t._uU(15),t.qZA()(),t.TgZ(16,"div",13)(17,"span",11),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"p",14),t._uU(21),t.qZA()(),t.TgZ(22,"div",15)(23,"p",16),t._uU(24),t.qZA()(),t.TgZ(25,"div",17),t.YNc(26,vt,6,4,"div",18),t.qZA(),t.TgZ(27,"div",15)(28,"p",19),t._uU(29),t.qZA()(),t.TgZ(30,"div",15)(31,"p",20),t._uU(32),t.qZA()()()()()()()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",!e.showPlaceholderImage),t.xp6(1),t.Q6J("ngIf",e.showPlaceholderImage),t.xp6(7),t.Oqu(t.lcZ(13,10,"PROFILE.TICKET_NO")),t.xp6(3),t.Oqu(e.ticketHistory.ticketId),t.xp6(3),t.Oqu(t.lcZ(19,12,"PROFILE.TYPE")),t.xp6(3),t.Oqu(e.ticketHistory.ticketTypeName),t.xp6(3),t.Oqu(e.ticketHistory.eventInstanceName),t.xp6(2),t.Q6J("ngIf",e.shouldDisplayBookableObjectLabel()),t.xp6(3),t.Oqu(e.ticketHistory.startDate),t.xp6(3),t.Oqu(e.ticketHistory.venueName)}}function _t(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",40),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",51),t._uU(5),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PROFILE.TYPE")),t.xp6(3),t.Oqu(e.ticketHistory.bookableObjectLabel)}}function xt(o,s){if(1&o&&(t.TgZ(0,"div",38)(1,"div",39)(2,"div",4)(3,"div",40),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",41),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"div",42),t._uU(10),t.qZA(),t.TgZ(11,"div",43),t._uU(12),t.qZA(),t.TgZ(13,"div",44),t._uU(14),t.qZA(),t.YNc(15,_t,6,4,"div",18),t.TgZ(16,"div",45),t._uU(17),t.qZA(),t.TgZ(18,"div",46),t._uU(19),t.qZA(),t._UZ(20,"div",47),t.qZA()()()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,8,"PROFILE.TICKET_NO")),t.xp6(3),t.Oqu(t.lcZ(8,10,"PROFILE.TYPE")),t.xp6(3),t.Oqu(e.ticketHistory.ticketId),t.xp6(2),t.Oqu(e.ticketHistory.ticketTypeName),t.xp6(2),t.Oqu(e.ticketHistory.eventInstanceName),t.xp6(1),t.Q6J("ngIf",e.shouldDisplayBookableObjectLabel()),t.xp6(2),t.Oqu(e.ticketHistory.startDate),t.xp6(2),t.Oqu(e.ticketHistory.venueName)}}let Tt=(()=>{class o{constructor(e,n,i,a,l){this.httpService=e,this.fileHelperService=n,this.fileSaver=i,this.cartService=a,this.cartHttpService=l,this.addExtraTicketsEvent=new t.vpe,this.showQRCode=!1,this.src="",this.showPlaceholderImage=!1,this.placeHolderImage="./assets/images/host.png"}ngOnInit(){this.src=`${b.z.EVENT.GET_IMAGE}/${this.ticket?this.ticket.eventInstanceId:this.ticketHistory.eventInstanceId}/${z.l.IMAGE_1_1}`}downloadTicket(e){this.httpService.downloadTicket(e).subscribe(n=>{this.downloadOnePdf(n.pdf,e)})}downloadOnePdf(e,n){if(!e)return;const i=this.fileHelperService.getBlob(e,"application/pdf");this.fileSaver.save(i,`ticket${n}.pdf`,"pdf")}onImageLoadError(){this.showPlaceholderImage=!0}displayQRCode(){this.showQRCode=!this.showQRCode}shouldDisplayBookableObjectLabel(){return this.ticket&&null!==this.ticket.bookableObjectLabel||this.ticketHistory&&null!==this.ticketHistory.bookableObjectLabel}addExtraTickets(e){e&&this.ticket.eventInstanceId&&e.orderId&&this.clearCartAndEmitEvent({eventInstanceId:this.ticket.eventInstanceId,orderId:this.ticket.orderId})}clearCartAndEmitEvent(e){if(!e)return;const n=this.cartService.getCartId();return n>0?this.cartHttpService.cancelCartSession(n,null).subscribe(i=>{i&&(this.cartService.clearCart(),this.addExtraTicketsEvent.emit(e))}):this.addExtraTicketsEvent.emit(e)}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(E.E),t.Y36(W.b),t.Y36(X.m9),t.Y36(Z.N),t.Y36(tt.R))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-sold-ticket"]],inputs:{ticket:"ticket",ticketHistory:"ticketHistory"},outputs:{addExtraTicketsEvent:"addExtraTicketsEvent"},decls:4,vars:4,consts:[["class","w-100 d-flex justify-content-center align-items-center",4,"ngIf"],["class","container-fluid",4,"ngIf"],[1,"w-100","d-flex","justify-content-center","align-items-center"],[1,"custom-card"],[1,"row"],["class","left col-4",4,"ngIf"],[1,"right","col-8"],[1,"ticket-content"],[1,"ticketNom"],[1,"number","row"],[1,"col-6","text-start"],[1,"fw-bolder"],[1,"text-start"],[1,"col-6","text-end"],[1,"text-end"],[1,"col-6"],[1,"text-start","custom-text","fw-bolder"],[1,"col-6","text-end","d-flex","justify-content-end"],[4,"ngIf"],[1,"text-start","fw-bolder"],[1,"text-end","fw-bolder","custom-text"],[1,"d-flex","mt-3","m-0","text-center"],[4,"ngIf","ngIfElse"],["hideExtraButton",""],[1,"left","col-4"],["alt","Sale Event Ticket",3,"src","error",4,"ngIf"],["alt","Sale Event Ticket",3,"src",4,"ngIf"],["alt","Sale Event Ticket",3,"src","error"],["alt","Sale Event Ticket",3,"src"],["class","d-flex justify-content-center mt-4",4,"ngIf"],[1,"d-flex","justify-content-center","mt-4"],["alt","qrcode",3,"qrdata","width","errorCorrectionLevel","elementType"],[1,"col-lg-4","pe-2"],["pButton","","pRipple","","type","button",1,"d-block","p-button-raised","p-button-success","fw-bold","fs-6","w-100",3,"click"],["pButton","","pRipple","","type","button",1,"d-block","w-100","p-button-raised","p-button-success","fw-bold","fs-6",3,"click"],[1,"col-lg-4"],[1,"col-lg-6","pe-2"],[1,"col-lg-6"],[1,"container-fluid"],[1,"small-ticket"],[1,"col-6","text-start","fw-bolder"],[1,"col-6","text-end","fw-bolder"],[1,"col-4","text-start","pb-3","pt-1","fw-normal"],[1,"col-8","text-end","pb-2","pt-1","fw-normal"],[1,"col-12","text-start","custom-text","fw-bolder","mb-3"],[1,"col-12","text-start","custom-font","fw-bolder"],[1,"col-6","text-start","custom-text","fw-bolder"],[1,"col-6","text-end","download"],[3,"click"],["class","d-flex justify-content-center mt-2",4,"ngIf"],[1,"col-lg-12"],[1,"col-12","text-start","custom-text","mb-3"],[1,"d-flex","justify-content-center","mt-2"]],template:function(n,i){1&n&&(t.YNc(0,dt,36,16,"div",0),t.YNc(1,mt,28,16,"div",1),t.YNc(2,ht,33,14,"div",0),t.YNc(3,xt,21,12,"div",1)),2&n&&(t.Q6J("ngIf",i.ticket),t.xp6(1),t.Q6J("ngIf",i.ticket),t.xp6(1),t.Q6J("ngIf",i.ticketHistory),t.xp6(1),t.Q6J("ngIf",i.ticketHistory))},dependencies:[p.O5,U.Hq,et.H,q.V,m.X$],styles:['.custom-card[_ngcontent-%COMP%]{width:100%;padding:15px;max-width:710px}.custom-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}.right[_ngcontent-%COMP%]:before{content:"circle";position:absolute;top:-4px;right:100%;border-radius:0 0 10rem 10rem;background:rgb(241,244,246);z-index:1;color:transparent;transform:translate(50%)}.right[_ngcontent-%COMP%]:after{content:"circle";position:absolute;bottom:-3px;right:100%;border-radius:10rem 10rem 0 0;color:transparent;background:rgb(241,244,246);z-index:1;transform:translate(50%)}.left[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:97%;border-radius:12px}.left[_ngcontent-%COMP%]{width:31%;padding:0;margin-left:14px;max-height:170px}.right[_ngcontent-%COMP%]{height:100%;max-height:170px;width:65%;border-radius:12px;background:#ffffff;padding:0;position:relative}.bottom-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.ticketNom[_ngcontent-%COMP%]{padding:18px 24px}.py-5[_ngcontent-%COMP%]{padding-top:0!important}[_nghost-%COMP%]     .p-button.p-button-secondary, [_nghost-%COMP%]   .p-buttonset.p-button-secondary[_ngcontent-%COMP%]{color:#fff;background:#000000;border:1px solid #000000;width:208px;height:63px}[_nghost-%COMP%]     .p-button:focus{box-shadow:0 0 0 2px #fff,0 0 0 4px #000,0 1px 2px #000}[_nghost-%COMP%]     .p-button.p-button-secondary:enabled:focus{box-shadow:0 0 0 2px #fff,0 0 0 4px #000,0 1px 2px #000}.download-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:32px;color:#000;margin-top:106px;font-family:var(--event-font-family);font-weight:600;font-size:16px;width:114px;display:flex;justify-content:center;align-items:center}.payment-success[_ngcontent-%COMP%]{padding:14px;background:#FFFFFF;box-shadow:0 2px 16px #0000000f;border-radius:8px;margin-top:32px}.payment-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding:24px 0}.small-ticket[_ngcontent-%COMP%]{background:#FFFFFF;box-shadow:0 1px 4px #0000000f;padding:24px 16px;margin-bottom:10px}.download[_ngcontent-%COMP%]{cursor:pointer;color:#3b82f6;font-family:var(--event-font-family);font-style:normal;font-weight:400;font-size:16px}@media (max-width: 760px){.custom-card[_ngcontent-%COMP%]{display:none}.payment-success[_ngcontent-%COMP%]{margin-top:0;border-radius:0}.continer[_ngcontent-%COMP%]{margin-top:0}}@media (min-width: 759px){.container-fluid[_ngcontent-%COMP%]{display:none}}']})}return o})();function It(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"app-sold-ticket",9),t.NdJ("addExtraTicketsEvent",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.handleEventInstanceId(i))}),t.qZA()}2&o&&t.Q6J("ticket",s.$implicit)}function Ct(o,s){if(1&o&&(t.TgZ(0,"div")(1,"p-carousel",6,7),t.YNc(3,It,1,1,"ng-template",8),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("value",e.soldTickets)("numVisible",2)("numScroll",1)("responsiveOptions",e.responsiveOptions)("circular",!0)("responsiveOptions",e.responsiveOptions)}}function yt(o,s){1&o&&(t.TgZ(0,"p",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.NO_BOOKINGS")))}function Zt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",2)(2,"p",3),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,Ct,4,6,"div",4),t.YNc(6,yt,3,3,"ng-template",null,5,t.W1O),t.qZA()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,3,"PROFILE.CURRENT_BOOKINGS")),t.xp6(2),t.Q6J("ngIf",n.soldTickets.length)("ngIfElse",e)}}function Pt(o,s){1&o&&t._UZ(0,"app-sold-ticket",11),2&o&&t.Q6J("ticketHistory",s.$implicit)}function bt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"p-carousel",6,7),t.YNc(3,Pt,1,1,"ng-template",8),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("value",e.ticketHistory)("numVisible",2)("numScroll",1)("responsiveOptions",e.responsiveOptions)("circular",!0)("responsiveOptions",e.responsiveOptions)}}function kt(o,s){1&o&&(t.TgZ(0,"p",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.NO_BOOKINGS")))}function Ot(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",2)(2,"p",3),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,bt,4,6,"div",4),t.YNc(6,kt,3,3,"ng-template",null,5,t.W1O),t.qZA()),2&o){const e=t.MAs(7),n=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,3,"PROFILE.PAST_BOOKINGS")),t.xp6(2),t.Q6J("ngIf",n.ticketHistory.length)("ngIfElse",e)}}let Et=(()=>{class o{constructor(e,n,i){this.httpService=e,this.route=n,this.datePipe=i,this.addExtraTicketsEvent=new t.vpe,this.soldTickets=[],this.responsiveOptions=[{breakpoint:"1300px",numVisible:2,numScroll:2},{breakpoint:"1150px",numVisible:1,numScroll:1},{breakpoint:"560px",numVisible:1,numScroll:1}]}ngOnInit(){this.fetchPurchasedActiveTickets(),this.fetchHistoryTickets()}handleEventInstanceId(e){this.addExtraTicketsEvent.emit(e)}fetchHistoryTickets(){this.httpService.getPurchasedTicketsByCustomer().subscribe(e=>{this.ticketHistory=e?this.mapResponsesToSoldTickets(e):[]})}fetchPurchasedActiveTickets(){this.httpService.activepurchases().subscribe(e=>{this.soldTickets=e?this.mapResponsesToSoldTickets(e):[]})}mapTicketToSoldTicket(e,n){const{eventInstanceName:i,venueName:a,eventInstanceId:l,renderSeatmap:g}=n;return{...e,eventInstanceName:i,venueName:a,startDate:this.formatDate(n.startDate),eventInstanceId:l,renderSeatmap:g}}mapResponsesToSoldTickets(e){return e.data.flatMap(n=>{const i=this.formatDate(n.startDate);return null===i?[]:this.mapEventToSoldTickets(n,i)})}mapEventToSoldTickets(e,n){return e.tickets.map(i=>this.mapTicketToSoldTicket(i,{eventInstanceName:e.eventInstanceName,venueName:e.venueName,startDate:n,eventInstanceId:e.eventInstanceId,endDate:e.endDate,renderSeatmap:e.renderSeatmap,tickets:[]}))}formatDate(e){const n=new Date(e);return isNaN(n.getTime())?null:new p.uU("en-US").transform(n,"dd/MMM HH:mm")||null}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(I.r),t.Y36(y.gz),t.Y36(p.uU))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-my-bookings"]],outputs:{addExtraTicketsEvent:"addExtraTicketsEvent"},decls:3,vars:2,consts:[[1,"container-fluid","mt-2"],[4,"ngIf"],[1,"d-flex","justify-content-start"],[1,"fs-2","fw-bold"],[4,"ngIf","ngIfElse"],["noBookings",""],[1,"custom",3,"value","numVisible","numScroll","responsiveOptions","circular"],["carousel",""],["pTemplate","item"],[3,"ticket","addExtraTicketsEvent"],[1,"no-booking-message"],[3,"ticketHistory"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,Zt,8,5,"div",1),t.YNc(2,Ot,8,5,"div",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",i.soldTickets),t.xp6(1),t.Q6J("ngIf",i.ticketHistory))},dependencies:[p.O5,v.jx,$.l,Tt,m.X$],styles:["[_nghost-%COMP%]     .carousel-item{display:flex;justify-content:center}[_nghost-%COMP%]     .p-carousel .p-carousel-indicators .p-carousel-indicator.p-highlight button{background:#2fd99e!important;color:#2fd99e;width:32px!important;height:8px!important}.container-fluid[_ngcontent-%COMP%]{width:100%;max-width:1800px;margin:0 auto}.no-booking-message[_ngcontent-%COMP%]{font-size:20px;text-align:left;margin-bottom:3%}"]})}return o})();var At=r(9058),wt=r(4448),St=r(6831),Nt=r(9424),Ft=r(3608);const Lt=function(){return{"ticketbox-color-text":!0}};function Ut(o,s){if(1&o&&(t.TgZ(0,"div",1)(1,"div",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",10),t._uU(5),t.ALo(6,"currency"),t.qZA()()),2&o){const e=t.oxw(3);t.xp6(2),t.Oqu(t.lcZ(3,3,"GENERAL.DISCOUNT")),t.xp6(2),t.Q6J("ngClass",t.DdM(10,Lt)),t.xp6(1),t.Oqu(t.gM2(6,5,-e.couponDiscount,"EUR","symbol","1.2-2"))}}function qt(o,s){if(1&o&&(t.ynx(0),t._UZ(1,"div",4),t.YNc(2,Ut,7,11,"div",9),t.BQk()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.isCouponValid)}}function Mt(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"a",3),t._uU(6," E-Ticket "),t.qZA()(),t._UZ(7,"div",4),t.TgZ(8,"div",5)(9,"div",2),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"div",2),t._uU(13),t.ALo(14,"currency"),t.qZA()(),t.YNc(15,qt,3,1,"ng-container",0),t._UZ(16,"div",4),t.TgZ(17,"div",6)(18,"div",7),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"div",8),t._uU(22),t.ALo(23,"currency"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,6,"GENERAL.DELIVERY")),t.xp6(7),t.Oqu(t.lcZ(11,8,"GENERAL.ORDER_FEE")),t.xp6(3),t.hij(" ",t.gM2(14,10,e.totalFee,"EUR","symbol","1.2-2"),""),t.xp6(2),t.Q6J("ngIf",e.isCouponValid),t.xp6(4),t.Oqu(t.lcZ(20,15,"GENERAL.ORDER_TOTAL")),t.xp6(3),t.Oqu(t.gM2(23,17,e.orderSum,"EUR","symbol","1.2-2"))}}let Rt=(()=>{class o{constructor(e,n){this.customerService=e,this.salesHttps=n,this.setFeesCheckout=new t.vpe,this.hasTickets=!1}ngOnInit(){this.customerService.cartData$.subscribe(e=>{if(e){if(this.ticketTypes=e,e.ticketsOfEvent.length>0)return this.hasTickets=!0,void this.initTicketTypes();this.resetPrices()}})}resetPrices(){this.totalFee=0,this.orderSum=0,this.totalAmount=0}initTicketTypes(){if(this.ticketTypes){const e=this.mapTicketsToFee(this.ticketTypes);this.salesHttps.eventFee(e).subscribe(n=>{this.customerService.setCheckoutFees(n),this.eventFees=n,this.totalFee=n.totalFeeAmount,this.orderSum=this.orderTotal(),localStorage.setItem("totalFee",String(n.totalFeeAmount))})}}orderTotal(){return this.orderSum=this.totalAmount=0,this.ticketTypes.ticketsOfEvent.forEach(e=>{const{price:n,count:i}=e;this.orderSum+=n*i,this.totalAmount+=n*i}),this.orderSum+=this.totalFee}mapTicketsToFee(e){const n=e.ticketsOfEvent.map(i=>({ticketTypeId:i.ticketTypeId,quantity:i.count,seatCategoryKey:i.seatCategoryKey}));return new Nt.x({eventId:e.eventId,ticketTypes:n})}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(x.v),t.Y36(E.E))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-fees"]],inputs:{ticketTypes:"ticketTypes"},outputs:{setFeesCheckout:"setFeesCheckout"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"d-flex","justify-content-between","px-3"],[1,"fs-6"],["pTooltip","The Ticket is delivered online through Email",1,"fw-bold","fs-6"],[1,"m-3","border-bottom"],[1,"d-flex","justify-content-between","px-3","pt-3"],[1,"d-flex","justify-content-between","px-3","mb-4"],[1,"fs-6","fw-bold"],[1,"fs-6","fw-bolder"],["class","d-flex justify-content-between px-3",4,"ngIf"],[1,"fs-6","fw-bold",3,"ngClass"]],template:function(n,i){1&n&&t.YNc(0,Mt,24,22,"div",0),2&n&&t.Q6J("ngIf",i.hasTickets)},dependencies:[p.mk,p.O5,Ft.u,p.H9,m.X$]})}return o})();var Dt=r(5732),Yt=r(1989);let Jt=(()=>{class o{constructor(e,n,i,a,l){this.translate=e,this.cartService=n,this.saleshttps=i,this.messageService=a,this.customerService=l,this.privacyPolicyChecked=!1,this.isButtonDisabled=!0}ngOnInit(){this.customerService.cartData$.subscribe(e=>{e&&(this.ticketTypes=e,e.ticketsOfEvent.length>0&&(this.isButtonDisabled=!1))}),this.customerService.eventFees$.subscribe(e=>{e&&(this.eventFees=e,this.orderTotal())})}paySecurely(){var e=this;return(0,u.Z)(function*(){if(!e.isValidTicketTypes())return;yield e.updatePrivacyPolicy();const n={amountWithoutFees:e.totalAmount,eventInstanceId:e.ticketTypes.eventInstanceId??0,feesTotal:e.eventFees.totalFeeAmount,ticketTypes:e.ticketTypes.ticketsOfEvent.map(a=>({ticketTypeId:a.ticketTypeId,quantity:a.count,price:a.price,bookableObjectLabel:a?.bookableObjectLabel,seatCategoryKey:a.seatCategoryKey})),isSeatmap:e.ticketTypes.isSeatmap,seatmapEventKey:e.ticketTypes.seatmapEventKey,language:e.translate.currentLang,paymentMethod:Dt.X.Visa,cartId:e.cartService.getCartId(),holdSessionToken:e.ticketTypes.seatmapHoldToken||"",totalAmountAfterDiscount:e.totalDiscountedAmount||e.totalAmount,couponCode:"",parentOrderId:e.getPerantOrderId()},i=yield e.saleshttps.checkout(n).toPromise();e.handlePaymentResponse(i)})()}getPerantOrderId(){if(this.ticketTypes.parentOrderId)return this.ticketTypes.parentOrderId;{const e=JSON.parse(localStorage.getItem("cartItems"));return e&&e.parentOrderId?e.parentOrderId:0}}isValidTicketTypes(){return!(!this.ticketTypes||this.ticketTypes.ticketsOfEvent.length<=0||!this.ticketTypes.eventInstanceId)}updatePrivacyPolicy(){this.saleshttps.updatePrivacyPolicy(this.privacyPolicyChecked).subscribe(e=>{})}handlePaymentResponse(e){e&&e.paymentUrl&&(this.cartService.setRoutingToPaymentUrl(e.paymentUrl),window.location.href=e.paymentUrl)}onPrivacyPolicyCheckboxChange(){if(this.privacyPolicyChecked){const e=this.translate.instant("UPDATE_POLICY");this.messageService.add({severity:"info",summary:"Updated",detail:e})}}navigateToPrivacyPolicy(){window.open("/privacy","_blank")}orderTotal(){return this.totalAmount=0,this.ticketTypes.ticketsOfEvent.forEach(e=>{const{price:n,count:i}=e;this.totalAmount+=n*i}),this.totalAmount}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(m.sK),t.Y36(Z.N),t.Y36(E.E),t.Y36(v.ez),t.Y36(x.v))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-payment"]],inputs:{ticketTypes:"ticketTypes"},decls:23,vars:21,consts:[["type","button",1,"btn","btn-primary","p-3","w-100","bg-black",3,"disabled","click"],[1,"pi","pi-lock","ms-2"],[1,"p-3","ps-0"],[1,"pt-1"],[1,"text-start","d-flex","align-items-start"],["inputId","privacyPolicy",1,"mt-1",3,"binary","ngModel","ngModelChange","onChange"],["for","privacyPolicy",1,"ps-2","event-fs"],["href","#",1,"agree",3,"click"],[1,"text-start","event-fs","pt-2"],["href","",1,"agree"]],template:function(n,i){1&n&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return i.paySecurely()}),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"i",1),t.qZA(),t.TgZ(4,"div",2)(5,"div",3)(6,"div",4)(7,"p-checkbox",5),t.NdJ("ngModelChange",function(l){return i.privacyPolicyChecked=l})("onChange",function(){return i.onPrivacyPolicyCheckboxChange()}),t.qZA(),t.TgZ(8,"label",6),t._uU(9),t.ALo(10,"translate"),t.TgZ(11,"a",7),t.NdJ("click",function(){return i.navigateToPrivacyPolicy()}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"span",8),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"span"),t._uU(18),t.ALo(19,"translate"),t.TgZ(20,"a",9),t._uU(21),t.ALo(22,"translate"),t.qZA()()()()()()),2&n&&(t.Q6J("disabled",i.isButtonDisabled),t.xp6(1),t.hij(" ",t.lcZ(2,9,"GENERAL.PAY_SECURELY"),""),t.xp6(6),t.Q6J("binary",!0)("ngModel",i.privacyPolicyChecked),t.xp6(2),t.hij(" ",t.lcZ(10,11,"READ_POLICY")," "),t.xp6(3),t.hij("",t.lcZ(13,13,"GENERAL.PRIVACY_POLICY")," "),t.xp6(3),t.hij(" ",t.lcZ(16,15,"GENERAL.ALL_SALES_ARE_FINAL")," "),t.xp6(3),t.hij(" ",t.lcZ(19,17,"GENERAL.YOU_AGREE_TO_OUR")," "),t.xp6(3),t.Oqu(t.lcZ(22,19,"GENERAL.TERMS_OF_USE")))},dependencies:[c.JJ,c.On,Yt.XZ,m.X$]})}return o})();function Qt(o,s){1&o&&(t.ynx(0),t._uU(1,", "),t.BQk())}function Ht(o,s){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,Qt,2,0,"ng-container",13),t.qZA()),2&o){const e=s.$implicit,n=s.last;t.xp6(1),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngIf",!n)}}let jt=(()=>{class o{constructor(e,n){this.translate=e,this.datePipe=n}ngOnInit(){}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(m.sK),t.Y36(p.uU))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-EventInfo"]],inputs:{selectedEventInstance:"selectedEventInstance"},decls:29,vars:26,consts:[[1,"row","p-2","custom-continar","m-auto"],[1,"fs-5","fw-bolder","p-3","pt-0","text-dark"],[1,"col-7","pb-3"],[1,"fs-6","fw-medium","text-start"],[1,"pi","pi-calendar","text-dark","pe-2","fw-bold"],[1,"col-5","pb-3"],[1,"text-dark","pi","pi-map-marker","pe-2","fw-bold"],[1,"pi","pi-globe","pe-1","text-dark"],[4,"ngFor","ngForOf"],["data-toggle","tooltip",1,"col-5","pb-3",3,"title"],["src","assets/icons/door-open.svg","alt","Door Open Icon",1,"icon-svg","pb-1","open-door-icon","pe-2"],[1,"small-screen"],[1,"border"],[4,"ngIf"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA(),t.TgZ(3,"div",2)(4,"div",3),t._UZ(5,"i",4),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"date"),t.ALo(9,"date"),t.ALo(10,"date"),t.qZA()()(),t.TgZ(11,"div",5)(12,"div",3),t._UZ(13,"i",6),t.TgZ(14,"span"),t._uU(15),t.qZA()()(),t.TgZ(16,"div",2)(17,"div",3),t._UZ(18,"i",7),t.YNc(19,Ht,3,2,"span",8),t.qZA()(),t.TgZ(20,"div",9),t.ALo(21,"translate"),t.ALo(22,"date"),t.TgZ(23,"div",3),t._UZ(24,"img",10),t.TgZ(25,"span",11),t._uU(26),t.ALo(27,"date"),t.qZA()()()(),t._UZ(28,"div",12)),2&n&&(t.xp6(2),t.hij(" ",i.selectedEventInstance.eventInstanceName," "),t.xp6(5),t.lnq("",t.xi3(8,9,i.selectedEventInstance.startDate,"dd")," - ",t.xi3(9,12,i.selectedEventInstance.endDate,"dd MMM"),", ",t.xi3(10,15,i.selectedEventInstance.endDate,"HH:mm"),""),t.xp6(8),t.Oqu(i.selectedEventInstance.venueName),t.xp6(4),t.Q6J("ngForOf",i.selectedEventInstance.languages),t.xp6(1),t.hYB("title","",t.lcZ(21,18,"GENERAL.DOORS_OPEN")," ",t.xi3(22,20,i.selectedEventInstance.doorsOpen,"HH:mm"),""),t.xp6(6),t.Oqu(t.xi3(27,23,i.selectedEventInstance.doorsOpen,"HH:mm")))},dependencies:[p.sg,p.O5,p.uU,m.X$],styles:[".custom-continar[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px}"]})}return o})(),Bt=(()=>{class o{constructor(e){this.customerService=e,this.isCouponValid=!1}ngOnInit(){this.selectedEventInstance&&(this.ticketTypes=this.mapToTicketTypes(this.selectedEventInstance))}handlePromoCodeResponse(e){if(null==e.response)return this.setAmountWithoutDiscount();const{promoCode:n,response:i}=e;this.promoCode=n.trim(),this.totalDiscountedAmount=i.totalDiscountedAmount,i&&i.status===At.K.Active&&(this.isCouponValid=!0,this.couponDiscount=i.discountAmount,this.couponDiscount>0&&(this.orderSum=i.totalDiscountedAmount+this.totalFee))}setAmountWithoutDiscount(){this.promoCode="",this.isCouponValid=!1,this.couponDiscount=0,this.orderSum=this.orderTotal()}orderTotal(){return this.orderSum=this.totalAmount=0,this.ticketTypes.ticketsOfEvent.forEach(e=>{const{price:n,count:i}=e;this.orderSum+=n*i,this.totalAmount+=n*i}),this.orderSum+=this.totalFee}mapToTicketTypes(e){const{eventInstanceName:n,eventId:i,startDate:a,endDate:l,eventInstanceId:g,parentOrderId:h,isRenderSeatmap:T,ticketTypes:Ie}=e;return{eventName:n,eventId:i,eventStartDate:a,eventEndDate:l,eventInstanceId:g,parentOrderId:h,isSeatmap:T,ticketsOfEvent:Ie.map(_=>({eventInstanceId:_.eventInstanceId,ticketCategoryId:_.ticketCategoryId,ticketTypeId:_.ticketTypeId,name:"",price:_.price,count:0,quantity:null,minQuantity:_.minQuantity,bookableObjectLabel:"",seatCategoryKey:"",maxQuantity:_.maxQuantity})),selectedSeatObjects:void 0,seatmapHoldToken:void 0,seatmapEventKey:void 0}}onCartDataReceived(e){e&&this.customerService.updateCartData(e)}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(x.v))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-linked-checkout"]],inputs:{selectedEventInstance:"selectedEventInstance"},decls:9,vars:4,consts:[[1,"row"],[1,"col-lg-4"],[1,"col-lg-4","bg-white"],[3,"selectedEventInstance"],[3,"selectedEventInstance","cartData"],[3,"ticketTypes"],[3,"promoCodeCheck"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t._UZ(3,"app-EventInfo",3),t.TgZ(4,"event-instance-prices",4),t.NdJ("cartData",function(l){return i.onCartDataReceived(l)}),t.qZA(),t._UZ(5,"app-fees",5),t.TgZ(6,"app-promotional-code",6),t.NdJ("promoCodeCheck",function(l){return i.handlePromoCodeResponse(l)}),t.qZA(),t._UZ(7,"app-payment",5),t.qZA(),t._UZ(8,"div",1),t.qZA()),2&n&&(t.xp6(3),t.Q6J("selectedEventInstance",i.selectedEventInstance),t.xp6(1),t.Q6J("selectedEventInstance",i.selectedEventInstance),t.xp6(1),t.Q6J("ticketTypes",i.ticketTypes),t.xp6(2),t.Q6J("ticketTypes",i.ticketTypes))},dependencies:[wt.U,St.z,Rt,Jt,jt]})}return o})();function Gt(o,s){if(1&o&&(t.TgZ(0,"div",11),t._UZ(1,"app-linked-checkout",12),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("selectedEventInstance",e.selectedEventInstance)}}function Kt(o,s){1&o&&(t.TgZ(0,"div",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TABLE.NO_DATA")," "))}let Vt=(()=>{class o{constructor(e,n,i,a,l,g){this.http=e,this.router=n,this.eventHttp=i,this.customerService=a,this.headerClickService=l,this.cartService=g,this.activeTabIndex=0,this.eventInstanceId=0,this.showEventInstanceData=!1}ngOnInit(){this.getCustomerDetails(),this.setupHeaderClickSubscription()}setupHeaderClickSubscription(){this.headerClickService.logoClicked$.subscribe(()=>{this.cartService.checkStoredExpirationTime()})}handleEventInsatnceId(e){var n=this;return(0,u.Z)(function*(){e&&(n.eventInstanceId=e.eventInstanceId,n.parentOrderId=e.orderId,n.activeTabIndex=2,yield n.getEventInstanceData(),n.getOrderInfoByIdes(e))})()}getOrderInfoByIdes(e){if(!e)return;const n={eventInstanceId:e.eventInstanceId,orderId:e.orderId,email:this.customerService.getCustomerEmail()};this.http.getOrderInfo(n).subscribe(i=>{this.updateAvailableQuantity(i)})}updateAvailableQuantity(e){e&&this.selectedEventInstance&&this.selectedEventInstance.ticketTypes&&this.selectedEventInstance.ticketTypes.forEach(n=>{const i=e.ticketTypes.find(a=>a.ticketTypeId===n.ticketTypeId&&e.eventInstanceId===n.eventInstanceId);i&&!n.isQuantityUnlimited&&(n.availableQuantity=n.availableQuantity-i.numberOfTicketsBought),i&&n.maxQuantity&&(n.maxQuantity=n.maxQuantity-i.numberOfTicketsBought)})}getEventInstanceData(){this.eventInstanceId&&this.eventHttp.GetEventInstanceData(this.eventInstanceId).subscribe(e=>{this.mapToEventInstanceItemModel(e)})}mapToEventInstanceItemModel(e){const n=new Y;return n.eventInstanceId=e.eventInstance.eventInstanceId,n.posterImage=e.eventInstance.posterImage,n.eventInstanceName=e.eventInstance.name,n.description=e.eventInstance.description,n.information=e.eventInstance.information,n.venueName=e.venue.name,n.address=e.venue.address,n.postalCode=e.venue.postalCode,n.latitude=e.venue.latitude,n.longitude=e.venue.longitude,n.doorsOpen=e.eventInstance.doorsOpen,n.startDate=e.eventInstance.startDate,n.endDate=e.eventInstance.endDate,n.isRenderSeatmap=e.eventInstance.renderSeatmap,n.languages=e.languages,n.ticketTypes=e.ticketTypes,n.ticketCategories=e.ticketCategories,n.eventId=e.event.eventId,n.eventInstanceCode="",n.isSoldout=e.ticketTypes.every(i=>i.isSoldout),n.prices=e.prices,n.parentOrderId=this.parentOrderId??void 0,this.showEventInstanceData=!!n,this.selectedEventInstance=n}getCustomerDetails(){var e=this;return(0,u.Z)(function*(){let n=yield(0,D.z)(e.http.getCustomerInfo());n&&(e.fullName=`${n.firstName} ${n.lastName}`,e.email=n?.email)})()}onChangesSaved(){this.getCustomerDetails()}navigateToPurchaseTicket(){this.router.navigate(["/event/ticket/buy"])}handleTabChange(e){this.activeTabIndex=e.index}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(I.r),t.Y36(y.F0),t.Y36(J.e),t.Y36(x.v),t.Y36(Q.W),t.Y36(Z.N))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-customer-profile"]],decls:19,vars:14,consts:[[1,"container-fluid","p-0","m-0"],[1,"text-start","text","ps-5"],[1,"fs-2","fw-bold"],[1,"fs-3","fw-normal","pb-3"],[3,"activeIndex","onChange"],[3,"header"],[3,"addExtraTicketsEvent"],[3,"changesSaved"],["class","row",4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-center"],["noData",""],[1,"row"],[3,"selectedEventInstance"],[1,"mt-5","fs-4","fw-bold"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t._uU(5),t.qZA()(),t.TgZ(6,"p-tabView",4),t.NdJ("onChange",function(l){return i.handleTabChange(l)}),t.TgZ(7,"p-tabPanel",5),t.ALo(8,"translate"),t.TgZ(9,"app-my-bookings",6),t.NdJ("addExtraTicketsEvent",function(l){return i.handleEventInsatnceId(l)}),t.qZA()(),t.TgZ(10,"p-tabPanel",5),t.ALo(11,"translate"),t.TgZ(12,"app-my-profile",7),t.NdJ("changesSaved",function(){return i.onChangesSaved()}),t.qZA()(),t.TgZ(13,"p-tabPanel",5),t.ALo(14,"translate"),t.YNc(15,Gt,2,1,"div",8),t.TgZ(16,"div",9),t.YNc(17,Kt,3,3,"ng-template",null,10,t.W1O),t.qZA()()()()),2&n){const a=t.MAs(18);t.xp6(3),t.Oqu(i.fullName),t.xp6(2),t.Oqu(i.email),t.xp6(1),t.Q6J("activeIndex",i.activeTabIndex),t.xp6(1),t.s9C("header",t.lcZ(8,8,"PROFILE.MY_BOOKINGS")),t.xp6(3),t.s9C("header",t.lcZ(11,10,"PROFILE.MY_PROFILE")),t.xp6(3),t.s9C("header",t.lcZ(14,12,"PROFILE.LINKED_TICKETS")),t.xp6(2),t.Q6J("ngIf",i.showEventInstanceData)("ngIfElse",a)}},dependencies:[p.O5,P.xf,P.x4,V,Et,Bt,m.X$],styles:["[_nghost-%COMP%]     .p-tabview-nav-container{position:relative;width:100%;max-width:50%}@media screen and (max-width: 768px){[_nghost-%COMP%]     .p-tabview-nav-container{max-width:none}}[_nghost-%COMP%]     .p-tabview .p-tabview-panels{background:#f1f4f6!important}[_nghost-%COMP%]     .p-tabview{background:var(--50, #F8F9FA)}[_nghost-%COMP%]     .p-tabview .p-tabview-nav li .p-tabview-nav-link{background:#f8f9fa!important}.text[_ngcontent-%COMP%]{background:var(--50, #F8F9FA)}[_nghost-%COMP%]     .p-tabview .p-tabview-panels{background-color:#000}.custome-card[_ngcontent-%COMP%]{width:500px}"]})}return o})();var M=r(2137);function $t(o,s){1&o&&(t.TgZ(0,"p",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PROFILE.COUNTRY&CITY_REQUIRED")," "))}function zt(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",3)(1,"form",4)(2,"div",5)(3,"div",6),t._UZ(4,"input",7),t.qZA(),t.TgZ(5,"div",6),t._UZ(6,"input",8),t.qZA()(),t.TgZ(7,"div",9)(8,"div",6),t._UZ(9,"input",10),t.YNc(10,$t,3,3,"p",11),t.qZA(),t.TgZ(11,"div",6),t._UZ(12,"input",12),t.qZA()(),t.TgZ(13,"div",9)(14,"div",6),t._UZ(15,"input",13),t.qZA(),t.TgZ(16,"div",6),t._UZ(17,"input",14),t.qZA()(),t.TgZ(18,"div",9)(19,"div",15)(20,"p-dropdown",16),t.NdJ("onChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onCountryChange(i))}),t.qZA()(),t.TgZ(21,"div",6),t._UZ(22,"p-dropdown",17),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.customerProfileForm),t.xp6(9),t.Q6J("ngIf",null==e.customerProfileForm.errors?null:e.customerProfileForm.errors.addressError),t.xp6(10),t.Q6J("options",e.countries)("showClear",!0),t.xp6(2),t.Q6J("options",e.cities)("showClear",!0)}}const Wt=function(){return{width:"50vw"}},Xt=function(){return{"960px":"75vw","640px":"100vw"}};let te=(()=>{class o{constructor(e,n,i,a,l,g,h){this.fb=e,this.customerHttpService=n,this.commonHttpService=i,this.messageService=a,this.confirmationService=l,this.breakpointObserver=g,this.translateService=h,this.imageSize=2e7,this.eventtHasPoter=!1,this.uploadedPoster="",this.countries=[],this.cities=[],this.imageLoading=!0,this.displayImage=!1,this.breakpointObserver.observe(["(max-width: 991px)"]).subscribe(T=>{this.isMobile=T.matches})}ngOnInit(){this.iniCountries(),this.iniCustomerProfile()}iniCustomerProfile(){var e=this;return(0,u.Z)(function*(){const n=yield(0,f.n)(e.customerHttpService.getCustomerInfo());if(n){if(e.customerProfile=n,e.imagePlaceHolder="data: "+n.contentType+";base64,"+n.image,e.customerProfile.image&&(e.customerProfile.fileName="profile.png",e.displayImage=!0,e.customerProfile.address.countryId)){const i=yield(0,f.n)(e.commonHttpService.getCitiesByCountry(e.customerProfile.address.countryId));i&&(e.cities=i.map(a=>({label:a.name,value:a.cityId})))}}else e.customerProfile=new C;e.imageLoading=!1,e.createForm()})()}onDelete(){var n,e=this;this.confirmationService.confirm({header:this.translateService.instant("PROFILE.DELETE_PIC"),message:this.translateService.instant("PROFILE.DELETE_PIC_DETAILS"),icon:"pi pi-exclamation-triangle",accept:(n=(0,u.Z)(function*(){e.imageLoading=!0,(yield(0,f.n)(e.customerHttpService.deleteCustomerProfilePicture()))&&(e.displayImage=!1),e.imageLoading=!1}),function(){return n.apply(this,arguments)}),acceptLabel:this.translateService.instant("GENERAL.TITLE_DELETE"),rejectLabel:this.translateService.instant("GENERAL.TITLE_CANCEL"),acceptIcon:"'",rejectIcon:"'"})}iniCountries(){var e=this;return(0,u.Z)(function*(){const n=yield(0,f.n)(e.commonHttpService.getCountries());n&&(e.countries=n.map(i=>({label:i.name,value:i.countryId})))})()}onCountryChange(e){var n=this;return(0,u.Z)(function*(){const i=e.value,a=yield(0,f.n)(n.commonHttpService.getCitiesByCountry(i));a&&(n.cities=a.map(l=>({label:l.name,value:l.cityId})))})()}createForm(){this.customerProfileForm=this.fb.group({firstName:[this.customerProfile.firstName,[c.kI.required,d.Fd]],lastName:[this.customerProfile.lastName,[c.kI.required,d.Fd]],addressId:[this.customerProfile?.address?.addressId],address1:[this.customerProfile?.address?.address1,[d.Fd]],address2:[this.customerProfile?.address?.address2,[d.Fd]],postCode:[this.customerProfile?.address?.postCode,[d.Fd]],mobile:[this.customerProfile?.mobile,[d.Fd,c.kI.pattern("^[0-9]*$")]],countryId:[this.customerProfile?.address?.countryId],cityId:[this.customerProfile?.address?.cityId],image:[this.customerProfile.image],fileName:[this.customerProfile.fileName]},{validators:[d.qf]})}prepareCustomerProfile(){const e=this.customerProfileForm.controls,n=new C;return n.firstName=e.firstName.value,n.lastName=e.lastName.value,n.address.addressId=e.addressId.value,n.address.address1=e.address1.value,n.address.address2=e.address2.value,n.address.postCode=e.postCode.value,n.mobile=e.mobile.value,n.address.countryId=e.countryId.value,n.address.cityId=e.cityId.value,n.image=e.image.value,n.fileName=e.fileName.value,n}onUpload(e){const n=new FileReader;n.readAsDataURL(this.uploadedFile),n.onload=()=>{this.base64Image=n.result,this.base64Image=this.base64Image.substring(this.base64Image.indexOf("base64")+7),this.customerProfileForm.controls.image.setValue(this.base64Image);const i=this.getFileName();this.customerProfileForm.controls.fileName.setValue(i)}}getFileName(){return this.uploadedFile.name.length>100?this.uploadedFile.name.substring(0,99)+"."+this.uploadedFile.type.substring(6):this.uploadedFile.name}onSelect(e){this.customerProfileForm.controls.image.reset(),this.customerProfileForm.controls.fileName.reset(),this.uploadedFile&&(this.uploadedFile=null),this.uploadedFile=e.files[0],this.imagePlaceHolder=URL.createObjectURL(this.uploadedFile),this.displayImage=!0}onSave(){var e=this;return(0,u.Z)(function*(){if(e.customerProfileForm.invalid)return;const n=e.prepareCustomerProfile();(yield(0,f.n)(e.customerHttpService.saveCustomerInfo(n)))&&e.messageService.add({severity:"success",summary:e.translateService.instant("PROFILE.UPDATE"),detail:e.translateService.instant("PROFILE.UPDATE_DETAILS")})})()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(c.qu),t.Y36(I.r),t.Y36(N),t.Y36(v.ez),t.Y36(v.YP),t.Y36(F.Yg),t.Y36(m.sK))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["customer-info"]],decls:4,vars:6,consts:[[1,"container-profile"],["class","container",4,"ngIf"],[3,"breakpoints"],[1,"container"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],["type","text","pInputText","","id","firstName","formControlName","firstName","placeholder","First Name",1,"custom-input"],["type","text","pInputText","","id","lastName","formControlName","lastName","placeholder","Last Name",1,"custom-input"],[1,"row","mt-3"],["type","text","pInputText","","id","address1","formControlName","address1","placeholder","Address 1",1,"custom-input"],["class","error-message",4,"ngIf"],["type","text","pInputText","","id","address2","formControlName","address2","placeholder","Address 2",1,"custom-input"],["type","text","pInputText","","id","postcode","formControlName","postCode","placeholder","Postcode",1,"custom-input"],["type","tel","pInputText","","id","mobilePhone","formControlName","mobile","placeholder","Mobile Phone",1,"custom-input"],[1,"col-md-6","pb-2"],["formControlName","countryId","placeholder","Country",3,"options","showClear","onChange"],["formControlName","cityId","placeholder","City",3,"options","showClear"],[1,"error-message"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,zt,23,6,"div",1),t.qZA(),t._UZ(2,"p-confirmDialog",2),t._uU(3," --\x3e\n")),2&n&&(t.xp6(1),t.Q6J("ngIf",i.customerProfileForm),t.xp6(1),t.Akn(t.DdM(4,Wt)),t.Q6J("breakpoints",t.DdM(5,Xt)))},dependencies:[p.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,k.Lt,L.o,M.Q,m.X$],styles:[".container-profile[_ngcontent-%COMP%]{background-color:#fff;border-radius:6px;padding:20px;box-shadow:0 4px 6px #0000001a;min-height:100vh}.custom-input[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ced4da;border-radius:4px;padding:12px 15px;width:100%;font-size:16px;line-height:1.5;color:#495057;margin-top:10px;box-shadow:0 2px 4px #0000001a;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.custom-input[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.row.mt-3[_ngcontent-%COMP%]{margin-top:25px!important}[_nghost-%COMP%]     .p-dropdown{width:100%;text-align:left}[_nghost-%COMP%]     .p-fileupload .p-fileupload-buttonbar p-button:nth-child(2){display:none}[_nghost-%COMP%]     .p-fileupload-buttonbar p-button:nth-child(3){display:none!important}[_nghost-%COMP%]     .unique-button{display:contents!important}[_nghost-%COMP%]     .p-fileupload .p-button-icon-only{display:none!important}.custom-Container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.upload-div[_ngcontent-%COMP%]{padding:1%;width:100%}.error-message[_ngcontent-%COMP%]{color:red!important;text-align:left!important}.poster[_ngcontent-%COMP%]{object-fit:cover}.placeHolder-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:207px;height:207px;background-color:#e3e5eb}[_nghost-%COMP%]     .p-fileupload .p-fileupload-buttonbar{background:none!important;border:none!important}.button-container[_ngcontent-%COMP%]{justify-content:space-between;width:100%}.no-margin-left[_ngcontent-%COMP%]{margin-left:0!important}.custom-padding[_ngcontent-%COMP%]{padding-top:30px!important}@media (max-width: 992px){.custom-file-upload[_ngcontent-%COMP%]   .mobile-upload-text[_ngcontent-%COMP%]{display:none}}@media (max-width: 992px){[_nghost-%COMP%]     .p-fileupload .p-fileupload-content{border:none!important;padding:0!important}[_nghost-%COMP%]     .p-fileupload .p-progressbar{display:none!important}}"]})}return o})();var ee=r(9937);function ne(o,s){1&o&&(t.TgZ(0,"small",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.SECURITY.OLD_PASS_REQUIRED")))}function oe(o,s){if(1&o&&(t.TgZ(0,"div",15),t.YNc(1,ne,3,3,"small",16),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.oldPassword.errors?null:e.oldPassword.errors.required)}}function ie(o,s){1&o&&(t.TgZ(0,"small",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.SECURITY.NEW_PASS_REQUIRED")))}function se(o,s){1&o&&(t.TgZ(0,"small",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.SECURITY.PASSWORD_REQUIRMENTS")))}function ae(o,s){if(1&o&&(t.TgZ(0,"div",15),t.YNc(1,ie,3,3,"small",16),t.YNc(2,se,3,3,"small",16),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.newPassword.errors?null:e.newPassword.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.newPassword.errors?null:e.newPassword.errors.pattern)}}function re(o,s){1&o&&(t.TgZ(0,"small",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PROFILE.SECURITY.CONFIRM_PASS_REQUIRED")))}function ce(o,s){if(1&o&&(t.TgZ(0,"div",15),t.YNc(1,re,3,3,"small",16),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.confirmNewPassword.errors?null:e.confirmNewPassword.errors.required)}}function le(o,s){1&o&&(t.TgZ(0,"div",18)(1,"p",19),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"PROFILE.SECURITY.PASS_MATCH")," "))}function de(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"form",3)(2,"div",4)(3,"div",5)(4,"div",6),t._UZ(5,"p-password",7),t.qZA(),t.YNc(6,oe,2,1,"div",8),t.qZA(),t.TgZ(7,"div",9),t._UZ(8,"p-password",10),t.YNc(9,ae,3,2,"div",8),t.qZA(),t.TgZ(10,"div",9),t._UZ(11,"p-password",11),t.YNc(12,ce,2,1,"div",8),t.qZA(),t.YNc(13,le,4,3,"div",12),t.qZA(),t._UZ(14,"div",5),t.TgZ(15,"div",13)(16,"p-button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updatePassword())}),t._uU(17),t.ALo(18,"translate"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.customerUpdatePasswordForm),t.xp6(4),t.Q6J("toggleMask",!0)("feedback",!1),t.xp6(1),t.Q6J("ngIf",e.oldPassword.invalid&&e.oldPassword.touched),t.xp6(2),t.Q6J("toggleMask",!0)("feedback",!1),t.xp6(1),t.Q6J("ngIf",e.newPassword.invalid&&e.newPassword.touched),t.xp6(2),t.Q6J("toggleMask",!0)("feedback",!1),t.xp6(1),t.Q6J("ngIf",e.confirmNewPassword.invalid&&e.confirmNewPassword.touched),t.xp6(1),t.Q6J("ngIf",null==e.customerUpdatePasswordForm.errors?null:e.customerUpdatePasswordForm.errors.mismatch),t.xp6(4),t.Oqu(t.lcZ(18,12,"PROFILE.SECURITY.UPDATE_PASSWORD"))}}let pe=(()=>{class o{constructor(e,n,i,a){this.fb=e,this.messageService=n,this.translateService=i,this.authService=a,this.customerUpdatePasswordForm=new c.cw({oldPassword:new c.NI("",[c.kI.required,d.Fd]),newPassword:new c.NI("",[c.kI.required,c.kI.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(.{5,})$"),d.Fd]),confirmNewPassword:new c.NI("",[c.kI.required,d.Fd])},[d.dN.MatchValidator("newPassword","confirmNewPassword")])}ngOnInit(){}get passwordMatchError(){return this.customerUpdatePasswordForm.getError("missmatch")&&this.customerUpdatePasswordForm.get("confirmNewPassword")?.touched}get oldPassword(){return this.customerUpdatePasswordForm.get("oldPassword")}get newPassword(){return this.customerUpdatePasswordForm.get("newPassword")}get confirmNewPassword(){return this.customerUpdatePasswordForm.get("confirmNewPassword")}updatePassword(){var e=this;return(0,u.Z)(function*(){e.customerUpdatePasswordForm.invalid||((yield e.authService.updatePassword(e.oldPassword?.value,e.newPassword?.value))?(e.messageService.add({severity:"success",summary:e.translateService.instant("PROFILE.UPDATE"),detail:e.translateService.instant("PROFILE.SECURITY.PASSWORD_UPDATED")}),e.customerUpdatePasswordForm.reset()):e.messageService.add({severity:"error",summary:e.translateService.instant("GENERAL.ERROR"),detail:e.translateService.instant("PROFILE.SECURITY.PASSWORD_FAIL")}))})()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(c.qu),t.Y36(v.ez),t.Y36(m.sK),t.Y36(ee.e))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["security"]],decls:2,vars:1,consts:[[1,"container-profile"],["class","container",4,"ngIf"],[1,"container"],[3,"formGroup"],[1,"col-md-6"],[1,"row"],[1,"col-12"],["formControlName","oldPassword","placeholder","Old Password",3,"toggleMask","feedback"],["class","col-12 error-msg",4,"ngIf"],[1,"mt-3"],["formControlName","newPassword","placeholder","New Password",3,"toggleMask","feedback"],["formControlName","confirmNewPassword","placeholder","Confirm Password",3,"toggleMask","feedback"],["class","error-msg",4,"ngIf"],[1,"col-12","d-flex","mt-3"],[3,"click"],[1,"col-12","error-msg"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"error-msg"],[1,"text-danger","pt-1"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t.YNc(1,de,19,14,"div",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",i.customerUpdatePasswordForm))},dependencies:[p.O5,c._Y,c.JJ,c.JL,c.sg,c.u,U.zx,O.ro,m.X$],styles:[".container-profile[_ngcontent-%COMP%]{background-color:#fff;border-radius:6px;padding:20px;box-shadow:0 4px 6px #0000001a;min-height:100vh}.custom-input[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ced4da;border-radius:4px;padding:12px 15px;width:100%;font-size:16px;line-height:1.5;color:#495057;margin-top:10px;box-shadow:0 2px 4px #0000001a;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.custom-input[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.row.mt-3[_ngcontent-%COMP%]{margin-top:25px!important}.error-msg[_ngcontent-%COMP%]{text-align:left!important}"]})}return o})();var ue=r(1327),me=r(3214),fe=r(7919),ge=r(4711),ve=r(7489),he=r(4357),_e=r(4898);const xe=[{path:"",component:Vt,children:[{path:"",redirectTo:"customer-info",pathMatch:"full"},{path:"customer-info",component:te},{path:"security",component:pe}]}];let Te=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#n=this.\u0275inj=t.cJS({imports:[p.ez,he.v,R.g,y.Bz.forChild(xe),me.l,ue.$9,fe.ml,k.kW,ge.O,ve.m,c.UX,M.D,O.gz,P.LU,m.aw.forChild(),q.N,_e.h]})}return o})()}}]);